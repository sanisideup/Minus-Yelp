<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../assets/img/favicon.ico">

    <title>
      Yelp Fusion API web app by sanisideup
      BlackTie.co - Sumo Landing website template
    </title>

    <!-- Bootstrap core CSS -->
    <link href="/assets/css/bootstrap.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="/assets/css/ionicons.min.css" rel="stylesheet">
    <link href="/assets/css/style.css" rel="stylesheet">


    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="/assets/js/ie10-viewport-bug-workaround.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>


  </head>

  <body>

    <div class="container ptb">
      <div class="col-md-6">

        <div class="container">
          <div class="col-md-6 result">
            <a href=<%= @url_2 %>>
            <hr />
              <div class="row">
                  <div id="preview" class="col-md-3"> <img src= <%= @image_url_0 %> width="100" alt=""> </div>
                  <div class="col-md-9"> <h2> <%= @name_0 %> </h2>
                    <h5> <%=@address_0[0] %> <%= @address_0[1] %> </h5>
                    <h5> <%=@phone_number_0 %> </h5>
                  </div>
                </div>
              <div class="col-md-6">
                <h5> Rating: <%= @rating_0 %> </h5>
                <h5> Price: <%= @price_0 %> </h5>
              </div>
              <div class="col-md-6">
                <h5> <%= @review_count_0 %> Reviews </h5>
                <h5> <%= @category_0 %> </h5>
              </div>
              <hr />
            </a>
          </div>
        </div>

        <div class="container">
          <div class="col-md-6 result">
            <a href=<%= @url_2 %>>
            <hr />
              <div class="row">
                  <div id="preview" class="col-md-3"> <img src= <%= @image_url_1 %> width="100" alt=""> </div>
                  <div class="col-md-9"> <h2> <%= @name_1 %> </h2>
                    <h5> <%=@address_1[0] %> <%= @address_1[1] %> </h5>
                    <h5> <%=@phone_number_1 %> </h5>
                  </div>
                </div>
              <div class="col-md-6">
                <h5> Rating: <%= @rating_1 %> </h5>
                <h5> Price: <%= @price_1 %> </h5>
              </div>
              <div class="col-md-6">
                <h5> <%= @review_count_1 %> Reviews </h5>
                <h5> <%= @category_1 %> </h5>
              </div>
              <hr />
            </a>
          </div>
        </div>

        <div class="container">
          <div class="col-md-6 result">
            <a href=<%= @url_2 %>>
            <hr />
              <div class="row">
                  <div id="preview" class="col-md-3"> <img src= <%= @image_url_2 %> width="100" alt=""> </div>
                  <div class="col-md-9"> <h2> <%= @name_2 %> </h2>
                    <h5> <%=@address_2[0] %> <%= @address_2[1] %> </h5>
                    <h5> <%=@phone_number_2 %> </h5>
                  </div>
                </div>
              <div class="col-md-6">
                <h5> Rating: <%= @rating_2 %> </h5>
                <h5> Price: <%= @price_2 %> </h5>
              </div>
              <div class="col-md-6">
                <h5> <%= @review_count_2 %> Reviews </h5>
                <h5> <%= @category_2 %> </h5>
              </div>
              <hr />
            </a>
          </div>
        </div>

      </div>

      <div class="col-md-6"> <div id="mapholder" ></div> </div>
    </div>


    <form role="form" action="/search" method="post" enctype="plain">
      <input type="hidden" id="lat" name="lat" value="" />
      <input type="hidden" id="lon" name="lon" value="" />
    </form>
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://maps.google.com/maps/api/js?key=AIzaSyDfllPCZ2TS4TAwnhaiyW09fV18x-kLzrY"></script>
    <script>
      var map;
      initMap();

      function initMap() {
          map = new google.maps.Map(document.getElementById('mapholder'), {
          zoom: 14,
          center: new google.maps.LatLng(<%= @lat_0 %>, <%= @lon_0 %>),
          mapTypeId: 'roadmap',
          navigationControlOptions: {style:google.maps.NavigationControlStyle.SMALL}
        });

        mapholder.style.height='641px';
        mapholder.style.width='500px';

        var icons = {
          yelp1: {
            icon: {
              url: "/assets/img/yelp1.png",
              scaledSize: new google.maps.Size(50, 50),
              origin: new google.maps.Point(0,0), // origin
              anchor: new google.maps.Point(0, 0) // anchor
              }
            },
            yelp2: {
              icon: {
                url: "/assets/img/yelp2.png",
                scaledSize: new google.maps.Size(50, 50),
                origin: new google.maps.Point(0,0), // origin
                anchor: new google.maps.Point(0, 0) // anchor
                }
              },
              yelp3: {
                icon: {
                  url: "/assets/img/yelp3.png",
                  scaledSize: new google.maps.Size(50, 50 ),
                  origin: new google.maps.Point(0,0), // origin
                  anchor: new google.maps.Point(0, 0) // anchor
                  }
                }
        };

        function addMarker(feature) {
          var marker = new google.maps.Marker({
            position: feature.position,
            icon: icons[feature.type].icon,
            map: map
          });
        }


        var features = [
          {
            position: new google.maps.LatLng(<%= @lat_0 %>, <%= @lon_0 %>),
            type: "yelp1"
          }, {
            position: new google.maps.LatLng(<%= @lat_1 %>, <%= @lon_1 %>),
            type: "yelp2"
          }, {
            position: new google.maps.LatLng(<%= @lat_2 %>, <%= @lon_2 %>),
            type: "yelp3"
          }
        ];

        for (var i = 0, feature; feature = features[i]; i++) {
          addMarker(feature);
        }
      }

      <!-- Unfortunately unreliable -->
      function getLocation() {
          if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(showPosition,showError, {timeout:10000});
          } else {
              x.innerHTML = "Geolocation is not supported by this browser.";}
      }

      function showPosition(position) {
        lat = position.coords.latitude;
        lon = position.coords.longitude;
        document.getElementById('lat').value = lat;
        document.getElementById('lon').value = lon;
      }

      function showError(error) {
          switch(error.code) {
              case error.PERMISSION_DENIED:
                  x.innerHTML = "User denied the request for Geolocation."
                  break;
              case error.POSITION_UNAVAILABLE:
                  x.innerHTML = "Location information is unavailable."
                  break;
              case error.TIMEOUT:
                  x.innerHTML = "The request to get user location timed out."
                  break;
              case error.UNKNOWN_ERROR:
                  x.innerHTML = "An unknown error occurred."
                  break;
          }
      }
    </script>

    <script src="assets/js/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    <script src="/assets/js/retina-1.1.0.js"></script>
  </body>
</html>
